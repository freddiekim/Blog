I"ô<h4 id="time--2019-06-09">Time : 2019-06-09</h4>
<h4 id="title--hello-cuda">Title : hello cuda</h4>

<h4 id="reference">reference</h4>

<p>ì°¸ì¡°í•œ ì‚¬ì´íŠ¸ ì •ë¦¬.</p>

<p>cuda ê¸°ì´ˆ <br />
â€“ <a href="http://haanjack.github.io/cuda/2016/03/27/cuda-prog-model.html">CUDA í”„ë¡œê·¸ë˜ë° ëª¨ë¸</a></p>

<p>â€“ <a href="https://github.com/dedoogong/cuda">CUDA ì˜ˆì œ</a></p>

<hr />
<h4 id="what-i-understood">what I understood</h4>
<p>ë‚´ê°€ ì´í•´í•œ ë‚´ìš© ì •ë¦¬. ìœ„ ì‚¬ì´íŠ¸ê°€ ì§„ì§œ ì‚¬ì´íŠ¸ì´ê³  ë‚œ ë‚´ê°€ ì´í•´í•œê±°ì™€ ì¶”ê°€ë¡œ í•„ìš”í•œ ì •ë³´ë¥¼ ì ì–´ ë†“ìœ¼ë ¤ê³ í•œë‹¤.</p>

<p>ì•„ë˜ ì²˜ëŸ¼ hello.cuë¥¼ ì‘ì„±í•˜ê³  ë¹Œë“œë¥¼í•˜ë©´</p>

<p>hello.cu</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>#include "../common/common.h"
#include &lt;stdio.h&gt;

__global__ void helloOnGPU()
{
    printf("Hello World on GPU!\n");
    printf("threadIdx:(%d, %d, %d)\n", threadIdx.x, gridDim.x, blockIdx.x);
}

int main(int argc, char **argv)
{
    printf("Hello World on CPU!\n");

    int numBlocks = 1;
    dim3 threadsPerBlock(10);

    helloOnGPU&lt;&lt;&lt;numBlocks, threadsPerBlock&gt;&gt;&gt;();
    CHECK(cudaDeviceReset());
    return 0;
}
</code></pre></div></div>

<p>ê²°ê³¼</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Hello World on CPU!
Hello World on GPU!
Hello World on GPU!
Hello World on GPU!
Hello World on GPU!
Hello World on GPU!
Hello World on GPU!
Hello World on GPU!
Hello World on GPU!
Hello World on GPU!
Hello World on GPU!
threadIdx:(0, 1, 0)
threadIdx:(1, 1, 0)
threadIdx:(2, 1, 0)
threadIdx:(3, 1, 0)
threadIdx:(4, 1, 0)
threadIdx:(5, 1, 0)
threadIdx:(6, 1, 0)
threadIdx:(7, 1, 0)
threadIdx:(8, 1, 0)
threadIdx:(9, 1, 0)
</code></pre></div></div>
<p>ì¦‰ threadë§Œ ìƒì„±ë˜ê³  blockì€ ê³ ì •ì´ë‹¤. ë‚´ê°€ ìœ„í•´ì„œ blockë‹¹ threadë¥¼ 10ê°œë¡œ ì„¤ì •í–ˆê¸° ë•Œë¬¸ì´ë‹¤. <br />
ê·¸ë¦¬ê³  gridì˜ ê°œìˆ˜ë¥¼ 1ê°œë¡œ ì„¤ì •í–ˆê¸° ë•Œë¬¸ì´ë‹¤. ê¸°ë³¸ì ìœ¼ë¡œ gridì˜ ê°œìˆ˜ëŠ” 1ì°¨ì›ì¸ ê²½ìš°</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>grid_nx = (nx + block.x - 1) / block.x;
grid_ny = (ny + block.y - 1) / block.y;
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>   í‚¤ì›Œë“œ         	ì˜ë¯¸  
__global__      CPU Main threadì—ì„œ í˜¸ì¶œ ê°€ëŠ¥í•œ GPUì—ì„œ ë™ì‘í•˜ëŠ” í•¨ìˆ˜ 
__host__        CPU Threadì—ì„œë§Œ ë™ì‘í•˜ëŠ” í•¨ìˆ˜ 
__device__      GPU ì»¤ë„í•¨ìˆ˜ ë‚´ë¶€ì—ì„œë§Œ í˜¸ì¶œ ê°€ëŠ¥í•œ GPU í•¨ìˆ˜ 
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Pre-defined      variables
dim3 gridDim     dimensions of grid
dim3  blockDim   dimensions of block
uint3 blockIdx   block index within grid
uint3 threadIdx  thread index within block
int   warpSize   number of threads in warp
</code></pre></div></div>

<p>ì¸ë±ì‹± ë°©ë²•</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ì¸ë±ì‹± ì¢…ë¥˜                  ì½”ë“œ
1ì°¨ì› ë°ì´í„°(x only)       blockDim.x * blockIdx.x + threadIdx.x
2ì°¨ì› ë°ì´í„°(x, y)         blockDim.x * blockIdx.x + threadIdx.x, blockDim.y * blockIdx.y + threadIdx.y
2ì°¨ì› ë°ì´í„°(x only)       N.x * blockDim.y * blockIdx.y + N.x * threadIdx.y + blockDim.x * blockIdx.x + blockIdx.x
</code></pre></div></div>

<h4 id="ê·¸ë˜í”½-ì¹´ë“œ-ì •ë³´-ì–»ì–´ì˜¤ê¸°">ê·¸ë˜í”½ ì¹´ë“œ ì •ë³´ ì–»ì–´ì˜¤ê¸°</h4>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cudaDeviceProp deviceProp;
CHECK(cudaGetDeviceProperties(&amp;deviceProp, dev));
printf("Using Device %d: %s\n", dev, deviceProp.name);
CHECK(cudaSetDevice(dev));
</code></pre></div></div>

<p>ê·¸ë˜í”½ ì¹´ë“œê°€ ì—¬ëŸ¬ê°œì¼ë•Œ í•„ìš”í•˜ì§€ ì•Šì„ê¹Œ???? ì•”íŠ¼ ìœ„ ì²˜ëŸ¼ ì½”ë“œë¥¼ ì‘ì„±í•˜ë©´ ë‚´ ê·¸ë˜í”½ ì •ë³´ê°€ ë‚˜ì˜¨ë‹¤.</p>

<p>ê·¸ë¦¬ê³  ìœ„ ì‚¬ì´íŠ¸ì—ì„œëŠ” ì¼ë°˜ì ìœ¼ë¡œ ìµœì ì‚¬ì´ì¦ˆ ë¸”ë½ì€ <strong>Block(16, 16)</strong> ì´ë¼ê³ í•œë‹¤. ì°¸ê³ í•˜ì!</p>

<h4 id="memory-ê³„ì¸µ">Memory ê³„ì¸µ</h4>

<p>CUDAì—ì„œ ì‚¬ìš©í•˜ëŠ” ë©”ëª¨ë¦¬ ê³„ì¸µì€ í¬ê²Œ ë‘ ê°€ì§€ë¡œ êµ¬ë³„ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>

<p>1) Global Memory</p>
<ul>
  <li>ê·¸ë˜í”½ ì¹´ë“œì— ì„¤ì¹˜ë˜ëŠ” ë©”ëª¨ë¦¬. 1Gì´ìƒ. ë‹¤ë¥¸ ë©”ëª¨ë¦¬ì— ë¹„í•´ ëŠë¦¬ë‹¤. ë¬¼ë¡  CPUì—ì„œ ì‚¬ìš©í•˜ëŠ” ë©”ëª¨ë¦¬ë³´ë‹¤ëŠ” ë¹ ë¥´ë‹¤. ëŒ€ì—­í­ì— ì‹ ê²½ì„ ì¨ì•¼ í•œë‹¤.
2) On-Chip memory</li>
  <li>Shared L2 Cache: CUDA Coreê°„ ê³µìœ í•˜ëŠ” Cache ë©”ëª¨ë¦¬. í”„ë¡œê·¸ë˜ë°ì— ë…¸ì¶œë˜ì§€ ì•ŠìŒ.</li>
  <li>Shared L1 Cache: CUDA Core ë‚´ì—ì„œ ì‚¬ìš©í•˜ëŠ” L1 Cache. (ì•½ 64KB. ì½”ì–´ ë²„ì „ë§ˆë‹¤ ë‹¤ë¦„). <strong>í”„ë¡œê·¸ë˜ë° ê°€ëŠ¥</strong></li>
  <li>Texture Memory: CUDA Coreê°€ ê³µìœ í•˜ëŠ” Pre-fetchë¥¼ ì§€ì›í•˜ëŠ” read-only cache. <strong>í”„ë¡œê·¸ë˜ë° ê°€ëŠ¥</strong>.</li>
  <li>Constant Memory: CUDA Coreê°€ ê³µìœ í•˜ëŠ” Kernel ì‹¤í–‰ì¤‘ ì—…ë°ì´íŠ¸ê°€ ë¶ˆê°€ëŠ¥í•œ read-only cache. <strong>í”„ë¡œê·¸ë˜ë° ê°€ëŠ¥</strong>.</li>
  <li>Register File: CUDA Threadê°€ ì‚¬ìš©í•˜ëŠ” Register</li>
</ul>

<p>ìœ„ ë©”ëª¨ë¦¬ë¥¼ ì´í•´í•˜ëŠ”ê²ƒì´ cuda ìµœì í™”í•˜ëŠ” ë°©ë²•ì´ë¼ê³ í•¨. ë‚œ ìš°ì„  ì‘ì„±ì´ë‚˜ í•´ë³´ì!!! \</p>
<blockquote>
  <p>ì´ ë¶€ë¶„ì„ ì˜ ì´í•´í•˜ëŠ” ê²ƒì´ CUDA í”„ë¡œê·¸ë˜ë°ì„ ìµœì í™” ì‹œì¼œë‚˜ê°€ëŠ”ë° ì¤‘ìš”í•œ ë¶€ë¶„ì´ë¼ê³  í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
</blockquote>
:ET
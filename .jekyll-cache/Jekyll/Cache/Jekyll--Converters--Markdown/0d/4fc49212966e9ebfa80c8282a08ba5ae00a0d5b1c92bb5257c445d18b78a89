I"9ü<h4 id="time--2018-06-05">Time : 2018-06-05</h4>
<h4 id="title--tensorflow-basic">Title : TensorFlow Basic</h4>
<ul>
  <li>https://github.com/golbin/TensorFlow-ML-Exercises/blob/master/03%20-%20Gradient%20Descendent/01.py</li>
  <li>ì¢‹ì€ ì˜ˆì œì´ë‹¤. ì½”ë“œë§Œìœ¼ë¡œë„ ì´í•´ê°€ ëœë‹¤. ìì„¸íˆ ì•Œë ¤ë©´ ê¸¸ê²Œ ëŠ˜ì–´ì§€ëŠ” ê²½í–¥ì´ ìˆìœ¼ë¯€ë¡œ ì½”ë“œ ì´í•´ë§Œ í•˜ê³  ë„˜ì–´ê°€ë„ë¡ í•˜ì.</li>
  <li>ìì„¸í•œ ë¬¼ë¦¬ì ì€ ë‚´ìš©ì€ ë‹´ì— ë‹¤ì‹œ ê³µë¶€í•˜ë„ë¡í•˜ì!.</li>
</ul>

<p>01 - TensorFlow Basic</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="n">tf</span>

  <span class="n">hello</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">constant</span><span class="p">(</span><span class="s">'Hello, TensorFlow!'</span><span class="p">)</span>

  <span class="n">sess</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span>

  <span class="k">print</span> <span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">hello</span><span class="p">)</span>
</code></pre></div></div>
<ul>
  <li>ëª¨ë“  ì–¸ì–´ì˜ ì‹œì‘ â€˜hello worldâ€™ tensor flowëŠ” sessionì„ ë§Œë“ í›„ runì„ í•´ì¤˜ì•¼ ë³€ìˆ˜ ë‚´ìš©ì„ ë³¼ ìˆ˜ ìˆë‹¤.
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sess</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span>

<span class="n">a</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">constant</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">constant</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>

<span class="n">c</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span>

<span class="k">print</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">c</span><span class="p">))</span>
</code></pre></div>    </div>
  </li>
  <li>sessionì„ ì‚¬ìš©í•˜ì§€ ì•Šìœ¼ë©´ â€˜Tensor(â€œadd:0â€, shape=(), dtype=int32)â€™ ì‹ìœ¼ë¡œ ë‚˜ì˜¨ë‹¤.
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">a</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">placeholder</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">int16</span><span class="p">)</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">placeholder</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">int16</span><span class="p">)</span>

<span class="n">add</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<span class="n">mul</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>

<span class="k">with</span> <span class="n">tf</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span> <span class="k">as</span> <span class="n">sess</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"Addition with variables: </span><span class="si">%</span><span class="s">i"</span> <span class="o">%</span> <span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">add</span><span class="p">,</span> <span class="n">feed_dict</span><span class="o">=</span><span class="p">{</span><span class="n">a</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="mi">3</span><span class="p">}))</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"Multiplication with variables: </span><span class="si">%</span><span class="s">i"</span> <span class="o">%</span> <span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">mul</span><span class="p">,</span> <span class="n">feed_dict</span><span class="o">=</span><span class="p">{</span><span class="n">a</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="mi">3</span><span class="p">}))</span>
</code></pre></div>    </div>
  </li>
  <li>ê³ ì •ëœ ê°’ì´ ì•„ë‹Œ ë³€ìˆ˜ì„ ì–¸í•˜ê³  ì‚¬ìš©í•˜ê³  ì‹¶ì„ë•ŒëŠ” placeholderë¥¼ ì‚¬ìš©í•œë‹¤.</li>
  <li>sessionì€ í•„ìš”í•˜ë‹¤.</li>
</ul>

<p>02 - Linear Regression</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="n">x_data</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
  <span class="n">y_data</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>

  <span class="n">W</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">random_uniform</span><span class="p">([</span><span class="mi">1</span><span class="p">],</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">))</span>
  <span class="n">b</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">random_uniform</span><span class="p">([</span><span class="mi">1</span><span class="p">],</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">))</span>

  <span class="n">init</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">global_variables_initializer</span><span class="p">()</span>
  <span class="n">sess</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span>
  <span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">init</span><span class="p">)</span>

  <span class="k">print</span><span class="p">(</span><span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">W</span><span class="p">))</span>
  <span class="k">print</span><span class="p">(</span><span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>

  <span class="n">hypothesis</span> <span class="o">=</span> <span class="n">W</span> <span class="o">*</span> <span class="n">x_data</span> <span class="o">+</span> <span class="n">b</span>

  <span class="k">print</span><span class="p">(</span><span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">hypothesis</span><span class="p">))</span>

  <span class="n">cost</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">reduce_mean</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">hypothesis</span> <span class="o">-</span> <span class="n">y_data</span><span class="p">))</span>

  <span class="n">a</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
  <span class="n">optimizer</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">GradientDescentOptimizer</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>

  <span class="n">train</span> <span class="o">=</span> <span class="n">optimizer</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span><span class="n">cost</span><span class="p">)</span>

  <span class="n">init</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">global_variables_initializer</span><span class="p">()</span>
  <span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">init</span><span class="p">)</span>

  <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2001</span><span class="p">):</span>
     <span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">train</span><span class="p">)</span>
     <span class="k">if</span> <span class="n">step</span> <span class="o">%</span> <span class="mi">20</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
         <span class="k">print</span><span class="p">(</span><span class="n">step</span><span class="p">,</span> <span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">cost</span><span class="p">),</span> <span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">W</span><span class="p">),</span> <span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">b</span><span class="p">),</span> <span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>

</code></pre></div></div>
<ul>
  <li>GradientDescentOptimizerë¥¼ ì‚¬ìš©í•´ì„œ ìµœì†Œê°’ì„ ì°¾ëŠ” ì˜ˆì œì´ë‹¤. ì†”ì§íˆ ë‚´ë¶€ê°€ ì¤‘ìš”í•˜ì§€ë§Œ ê·¸ëƒ¥ ì´ë ‡ê²Œ ëœë‹¤ê³  ì´í•´í•˜ê³  ë„˜ì–´ê°€ì!.</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="n">X</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">placeholder</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
  <span class="n">Y</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">placeholder</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>

  <span class="n">hypothesis</span> <span class="o">=</span> <span class="n">W</span><span class="o">*</span><span class="n">X</span> <span class="o">+</span> <span class="n">b</span>

  <span class="n">cost</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">reduce_mean</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">hypothesis</span> <span class="o">-</span> <span class="n">Y</span><span class="p">))</span>

  <span class="n">a</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
  <span class="n">optimizer</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">GradientDescentOptimizer</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
  <span class="n">train</span> <span class="o">=</span> <span class="n">optimizer</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span><span class="n">cost</span><span class="p">)</span>

  <span class="n">init</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">global_variables_initializer</span><span class="p">()</span>

  <span class="n">sess</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span>
  <span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">init</span><span class="p">)</span>

  <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">201</span><span class="p">):</span>
      <span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">train</span><span class="p">,</span> <span class="n">feed_dict</span><span class="o">=</span><span class="p">{</span><span class="n">X</span><span class="p">:</span> <span class="n">x_data</span><span class="p">,</span> <span class="n">Y</span><span class="p">:</span> <span class="n">y_data</span><span class="p">})</span>
      <span class="k">if</span> <span class="n">step</span> <span class="o">%</span> <span class="mi">20</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
          <span class="k">print</span><span class="p">(</span><span class="n">step</span><span class="p">,</span> <span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">cost</span><span class="p">,</span> <span class="n">feed_dict</span><span class="o">=</span><span class="p">{</span><span class="n">X</span><span class="p">:</span> <span class="n">x_data</span><span class="p">,</span> <span class="n">Y</span><span class="p">:</span> <span class="n">y_data</span><span class="p">}),</span> <span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">W</span><span class="p">),</span> <span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">b</span><span class="p">),</span> <span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>

  <span class="c1"># ë³€ìˆ˜ë¡œ ì„ ì–¸ ë˜ì–´ ìˆìœ¼ë¯€ë¡œ print(sess.run(cost) ê°™ì€ ëª…ë ¹ì–´ëŠ” ì•ˆëœë‹¤.
</span>  <span class="k">print</span><span class="p">(</span><span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">hypothesis</span><span class="p">,</span> <span class="n">feed_dict</span><span class="o">=</span><span class="p">{</span><span class="n">X</span><span class="p">:</span> <span class="mi">5</span><span class="p">}))</span>
  <span class="k">print</span><span class="p">(</span><span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">hypothesis</span><span class="p">,</span> <span class="n">feed_dict</span><span class="o">=</span><span class="p">{</span><span class="n">X</span><span class="p">:</span> <span class="mf">2.5</span><span class="p">}))</span>

  <span class="c1"># output
</span>  <span class="mi">0</span> <span class="mf">0.07728991</span> <span class="p">[</span><span class="mf">1.0468608</span><span class="p">]</span> <span class="p">[</span><span class="mf">0.1816434</span><span class="p">]</span> <span class="mf">0.1</span>
  <span class="mi">20</span> <span class="mf">0.0009866584</span> <span class="p">[</span><span class="mf">0.96351796</span><span class="p">]</span> <span class="p">[</span><span class="mf">0.0829323</span><span class="p">]</span> <span class="mf">0.1</span>
  <span class="mi">40</span> <span class="mf">0.00037278436</span> <span class="p">[</span><span class="mf">0.9775754</span><span class="p">]</span> <span class="p">[</span><span class="mf">0.05097649</span><span class="p">]</span> <span class="mf">0.1</span>
  <span class="mi">60</span> <span class="mf">0.00014084911</span> <span class="p">[</span><span class="mf">0.98621607</span><span class="p">]</span> <span class="p">[</span><span class="mf">0.03133404</span><span class="p">]</span> <span class="mf">0.1</span>
  <span class="mi">80</span> <span class="mf">5.3216005e-05</span> <span class="p">[</span><span class="mf">0.9915274</span><span class="p">]</span> <span class="p">[</span><span class="mf">0.0192603</span><span class="p">]</span> <span class="mf">0.1</span>
  <span class="mi">100</span> <span class="mf">2.0106274e-05</span> <span class="p">[</span><span class="mf">0.99479204</span><span class="p">]</span> <span class="p">[</span><span class="mf">0.01183888</span><span class="p">]</span> <span class="mf">0.1</span>
  <span class="mi">120</span> <span class="mf">7.5968624e-06</span> <span class="p">[</span><span class="mf">0.9967988</span><span class="p">]</span> <span class="p">[</span><span class="mf">0.00727708</span><span class="p">]</span> <span class="mf">0.1</span>
  <span class="mi">140</span> <span class="mf">2.8704237e-06</span> <span class="p">[</span><span class="mf">0.9980323</span><span class="p">]</span> <span class="p">[</span><span class="mf">0.00447307</span><span class="p">]</span> <span class="mf">0.1</span>
  <span class="mi">160</span> <span class="mf">1.084452e-06</span> <span class="p">[</span><span class="mf">0.9987905</span><span class="p">]</span> <span class="p">[</span><span class="mf">0.00274946</span><span class="p">]</span> <span class="mf">0.1</span>
  <span class="mi">180</span> <span class="mf">4.09767e-07</span> <span class="p">[</span><span class="mf">0.99925655</span><span class="p">]</span> <span class="p">[</span><span class="mf">0.00169003</span><span class="p">]</span> <span class="mf">0.1</span>
  <span class="mi">200</span> <span class="mf">1.548105e-07</span> <span class="p">[</span><span class="mf">0.99954295</span><span class="p">]</span> <span class="p">[</span><span class="mf">0.00103882</span><span class="p">]</span> <span class="mf">0.1</span>
  <span class="p">[</span><span class="mf">4.998754</span><span class="p">]</span>
  <span class="p">[</span><span class="mf">2.4998963</span><span class="p">]</span>
</code></pre></div></div>
<ul>
  <li>placeholderë¥¼ ì‚¬ìš©í•´ì„œ x,yë¥¼ ë³€ìˆ˜ë¡œ ì‚¬ìš©í•˜ëŠ” ì˜ˆì´ë‹¤. ë°‘ì— ë³´ë©´ í•™ìŠµì´ ì œëŒ€ë¡œ ë˜ì–´ì„œ 5-&gt;4.9, 2.5 -&gt; 2.49ì˜ ê²°ê³¼ê°€ ë‚˜ì˜¤ëŠ”ê²ƒì„</li>
  <li>í™•ì¸í•  ìˆ˜ ìˆë‹¤.</li>
</ul>

<p>02 - Gradient Descendent</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="n">X</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">3.</span><span class="p">]</span>
  <span class="n">Y</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">3.</span><span class="p">]</span>

  <span class="n">m</span> <span class="o">=</span> <span class="n">n_samples</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

  <span class="n">W</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">placeholder</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>

  <span class="n">hypothesis</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">W</span><span class="p">)</span>

  <span class="n">cost</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">reduce_mean</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="nb">pow</span><span class="p">(</span><span class="n">hypothesis</span> <span class="o">-</span> <span class="n">Y</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span><span class="o">/</span> <span class="n">m</span>

  <span class="n">W_val</span> <span class="o">=</span> <span class="p">[]</span>
  <span class="n">cost_val</span> <span class="o">=</span> <span class="p">[]</span>

  <span class="n">sess</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span>

  <span class="n">init</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">global_variables_initializer</span><span class="p">()</span>
  <span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">init</span><span class="p">)</span>

  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="mi">50</span><span class="p">):</span>
      <span class="k">print</span><span class="p">(</span> <span class="n">i</span><span class="o">*</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">cost</span><span class="p">,</span> <span class="n">feed_dict</span><span class="o">=</span><span class="p">{</span><span class="n">W</span><span class="p">:</span> <span class="n">i</span><span class="o">*</span><span class="mf">0.1</span><span class="p">}))</span>
      <span class="n">W_val</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="o">*</span><span class="mf">0.1</span><span class="p">)</span>
      <span class="n">cost_val</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">cost</span><span class="p">,</span> <span class="n">feed_dict</span><span class="o">=</span><span class="p">{</span><span class="n">W</span><span class="p">:</span> <span class="n">i</span><span class="o">*</span><span class="mf">0.1</span><span class="p">}))</span>


  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">W_val</span><span class="p">,</span> <span class="n">cost_val</span><span class="p">,</span> <span class="s">'ro'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">'cost'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">'W'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>
<ul>
  <li>ìœ„ ì˜ˆì œëŠ” matplotlibë¥¼ ì‚¬ìš©í•´ì„œ ê·¸ë˜í”„ë¥¼ ê·¸ë¦¬ëŠ” ì˜ˆì œì´ë‹¤.</li>
  <li>tf.pow(hypothesis - Y, 2) (w*x - y)^2 í•œ í›„ í‰ê· ì„ êµ¬í•¨ ì…ë ¥ì´ 3ê°œ wê°€ 3ê°œ ì´ë¯€ í‰ê· ì„ êµ¬í•˜ê³  /3ì„ í•œë‹¤.</li>
  <li>ìµœì†Œê°’ì€ i = 10ì¼ë•Œ ì¦‰ w = 1ì¼ ë•Œ 0ì´ ë‚˜ì˜¨ë‹¤.</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># exercise 2
</span>
    <span class="n">x_data</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">3.</span><span class="p">]</span>
    <span class="n">y_data</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">3.</span><span class="p">]</span>

    <span class="n">W</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">random_uniform</span><span class="p">([</span><span class="mi">1</span><span class="p">],</span> <span class="o">-</span><span class="mf">10.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">))</span>

    <span class="n">X</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">placeholder</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">placeholder</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>

    <span class="n">hypothesis</span> <span class="o">=</span> <span class="n">W</span><span class="o">*</span><span class="n">X</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">cost</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">reduce_mean</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">hypothesis</span> <span class="o">-</span> <span class="n">Y</span><span class="p">))</span>

    <span class="n">decent</span> <span class="o">=</span> <span class="n">W</span> <span class="o">-</span> <span class="n">tf</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">tf</span><span class="o">.</span><span class="n">reduce_mean</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span> <span class="o">-</span> <span class="n">Y</span><span class="p">,</span> <span class="n">X</span><span class="p">)))</span>
    <span class="n">update</span> <span class="o">=</span> <span class="n">W</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">decent</span><span class="p">)</span>

    <span class="n">sess</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span>
    <span class="n">init</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">global_variables_initializer</span><span class="p">()</span>
    <span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">init</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="n">step</span><span class="p">,</span> <span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">update</span><span class="p">,</span> <span class="n">feed_dict</span><span class="o">=</span><span class="p">{</span><span class="n">X</span><span class="p">:</span> <span class="n">x_data</span><span class="p">,</span> <span class="n">Y</span><span class="p">:</span> <span class="n">y_data</span><span class="p">}))</span>
        <span class="k">print</span><span class="p">(</span><span class="n">step</span><span class="p">,</span> <span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">cost</span><span class="p">,</span> <span class="n">feed_dict</span><span class="o">=</span><span class="p">{</span><span class="n">X</span><span class="p">:</span> <span class="n">x_data</span><span class="p">,</span> <span class="n">Y</span><span class="p">:</span> <span class="n">y_data</span><span class="p">}),</span> <span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">W</span><span class="p">))</span>
</code></pre></div></div>
<ul>
  <li>ì˜¤ì°¨ (w<em>x - y)</em>x í‰ê·  * 0.1 ì¦‰ 0.1ì€ stepì¦‰ ë°˜ì˜ ë¹„ìœ¨ì„ ì˜ë¯¸í•˜ëŠ”ê²ƒ ê°™ë‹¤.</li>
  <li>ìœ„ ì½”ë“œë¥¼ í†µí•´ì„œ GradientDescentOptimizerë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šê³  wê°’ì„ í•™ìŠµì‹œì¼œë´¤ë‹¤.</li>
  <li>ìœ„ ì½”ë“œë¥¼ ì´í•´í•˜ê¸° ìœ„í•´ì„œ ì•„ë˜ assignê¸°ëŠ¥ì„ ì´í•´í•´ì•¼í•œë‹¤. ì¬ê·€ì ìœ¼ë¡œ ê°’ì„ ê³„ì† ë°˜ì˜í•˜ê³  ì‹¶ì„ë•ŒëŠ” ì•„ë˜ì²˜ëŸ¼ assignì„ ì‚¬ìš©í•´ì„œ</li>
  <li>êµ¬ì„±í•œë‹¤.
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">init</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">global_variables_initializer</span><span class="p">()</span>
<span class="n">sess</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span>
<span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">init</span><span class="p">)</span>

<span class="n">decent</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">x</span>
<span class="n">assign_op</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">decent</span><span class="p">)</span>

<span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">assign_op</span><span class="p">)</span>
<span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">assign_op</span><span class="p">)</span>
<span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">assign_op</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">assign_op</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</code></pre></div>    </div>
  </li>
</ul>

<p>04 - Multi-variables Linear Regression</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="n">x1_data</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
  <span class="n">x2_data</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
  <span class="n">y_data</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>

  <span class="n">W1</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">random_uniform</span><span class="p">([</span><span class="mi">1</span><span class="p">],</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">))</span>
  <span class="n">W2</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">random_uniform</span><span class="p">([</span><span class="mi">1</span><span class="p">],</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">))</span>
  <span class="n">b</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">random_uniform</span><span class="p">([</span><span class="mi">1</span><span class="p">],</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">))</span>

  <span class="n">hypothesis</span> <span class="o">=</span> <span class="n">W1</span> <span class="o">*</span> <span class="n">x1_data</span> <span class="o">+</span> <span class="n">W2</span> <span class="o">*</span> <span class="n">x2_data</span> <span class="o">+</span> <span class="n">b</span>

  <span class="n">cost</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">reduce_mean</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">hypothesis</span> <span class="o">-</span> <span class="n">y_data</span><span class="p">))</span>

  <span class="n">a</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>  <span class="c1"># learning rate
</span>  <span class="n">optimizer</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">GradientDescentOptimizer</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
  <span class="n">train</span> <span class="o">=</span> <span class="n">optimizer</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span><span class="n">cost</span><span class="p">)</span>

  <span class="n">init</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">global_variables_initializer</span><span class="p">()</span>

  <span class="n">sess</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span>
  <span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">init</span><span class="p">)</span>

  <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2001</span><span class="p">):</span>
      <span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">train</span><span class="p">)</span>
      <span class="k">if</span> <span class="n">step</span> <span class="o">%</span> <span class="mi">20</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
          <span class="k">print</span><span class="p">(</span><span class="n">step</span><span class="p">,</span> <span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">cost</span><span class="p">),</span> <span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">W1</span><span class="p">),</span> <span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">W2</span><span class="p">),</span> <span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>

  <span class="k">print</span><span class="p">(</span><span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">hypothesis</span><span class="p">))</span>
</code></pre></div></div>
<ul>
  <li>ì´ë²ˆì—ëŠ” Wê°€ 2ê°œì´ë‹¤ ì´ë•Œ ì–´ë–»ê²Œ í•™ìŠµë˜ëŠ”ì§€ ë³´ì—¬ì£¼ê³  ìˆë‹¤.</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="n">x_data</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">3.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">5.</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">4.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]]</span>

  <span class="n">y_data</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>

  <span class="n">W</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">random_uniform</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">))</span>
  <span class="n">b</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">random_uniform</span><span class="p">([</span><span class="mi">1</span><span class="p">],</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">))</span>

  <span class="n">hypothesis</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">x_data</span><span class="p">)</span> <span class="o">+</span> <span class="n">b</span>

  <span class="n">cost</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">reduce_mean</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">hypothesis</span> <span class="o">-</span> <span class="n">y_data</span><span class="p">))</span>

  <span class="n">a</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
  <span class="n">optimizer</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">GradientDescentOptimizer</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
  <span class="n">train</span> <span class="o">=</span> <span class="n">optimizer</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span><span class="n">cost</span><span class="p">)</span>

  <span class="c1"># ì´ˆê¸°ê°’ì„ ì´ë•Œ ì„ ì–¸í•´ì¤˜ì•¼ ì—ëŸ¬ê°€ ë‚˜ì§€ ì•ŠëŠ”ë‹¤.
</span>  <span class="n">init</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">global_variables_initializer</span><span class="p">()</span>
  <span class="n">sess</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span>
  <span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">init</span><span class="p">)</span>

  <span class="k">print</span><span class="p">(</span><span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">W</span><span class="p">))</span>

  <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2001</span><span class="p">):</span>
      <span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">train</span><span class="p">)</span>
      <span class="k">if</span> <span class="n">step</span><span class="o">%</span> <span class="mi">100</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">step</span> <span class="o">&lt;</span> <span class="mi">10</span> <span class="p">:</span>
          <span class="k">print</span><span class="p">(</span><span class="n">step</span><span class="p">,</span> <span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">cost</span><span class="p">),</span> <span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">W</span><span class="p">),</span> <span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="p">)</span>

  <span class="k">print</span><span class="p">(</span><span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">hypothesis</span><span class="p">))</span>
</code></pre></div></div>
<ul>
  <li>ì˜ˆì œ 1ì„ matrixí˜•íƒœë¡œ êµ¬ì„±í•œë‹¤ìŒ ê³„ì‚°ì„í•œ ì˜ˆì´ë‹¤. ê°™ì€ ì˜ˆ</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="n">x_data</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">3.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">5.</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">4.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]]</span>
  <span class="n">y_data</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>

  <span class="k">print</span><span class="p">(</span><span class="n">x_data</span><span class="p">)</span>
  <span class="k">print</span><span class="p">(</span><span class="n">y_data</span><span class="p">)</span>

  <span class="n">W</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">random_uniform</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">))</span>

  <span class="n">hypothesis</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">x_data</span><span class="p">)</span>

  <span class="n">cost</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">reduce_mean</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">hypothesis</span> <span class="o">-</span> <span class="n">y_data</span><span class="p">))</span>

  <span class="n">a</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
  <span class="n">optimizer</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">GradientDescentOptimizer</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
  <span class="n">train</span> <span class="o">=</span> <span class="n">optimizer</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span><span class="n">cost</span><span class="p">)</span>

  <span class="n">init</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">global_variables_initializer</span><span class="p">()</span>

  <span class="n">sess</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span>
  <span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">init</span><span class="p">)</span>

  <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2001</span><span class="p">):</span>
      <span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">train</span><span class="p">)</span>
      <span class="k">if</span> <span class="n">step</span> <span class="o">%</span> <span class="mi">100</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">step</span> <span class="o">&lt;=</span> <span class="mi">5</span><span class="p">:</span>
          <span class="k">print</span><span class="p">(</span><span class="n">step</span><span class="p">,</span> <span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">cost</span><span class="p">),</span> <span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">W</span><span class="p">))</span>

  <span class="n">result</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">x_data</span><span class="p">)</span>
  <span class="c1"># ì‰¬ìš´ ì˜ˆì œì´ë¯€ë¡œ weightê°€ 0 1 1 ë¡œ ìˆ˜ë ´í•˜ëŠ”ê²ƒì„ í™•ì¸ í•  ìˆ˜ ìˆë‹¤.
</span>  <span class="k">print</span><span class="p">(</span><span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">result</span><span class="p">))</span>
</code></pre></div></div>
<ul>
  <li>weightë¥¼ 3ê°œê¹Œì§€ ëŠ˜ë ¤ ë´¤ì„ ë•Œ ì˜ˆì´ë‹¤. ê·¸ëƒ¥ ë‹¨ìˆœ ì…ë ¥ ì¦ê°€ì´ë‹¤.</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>   <span class="n">script_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">__file__</span><span class="p">))</span>
   <span class="k">print</span><span class="p">(</span><span class="n">__file__</span><span class="p">)</span>
   <span class="n">train_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">script_dir</span> <span class="o">+</span> <span class="s">'/train_04.txt'</span><span class="p">,</span> <span class="n">unpack</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s">'float32'</span><span class="p">)</span>

   <span class="c1"># ì•„ë˜ ì½”ë“œë¥¼ í†µí•´ì„œ 0ì€ ì‹œì‘ index -1ì€ ëì„ ë§í•˜ëŠ”ê²ƒì„ í™•ì¸ í•  ìˆ˜ ìˆë‹¤.
</span>   <span class="n">x_data</span> <span class="o">=</span> <span class="n">train_data</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
   <span class="n">y_data</span> <span class="o">=</span> <span class="n">train_data</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

   <span class="k">print</span><span class="p">(</span><span class="n">x_data</span><span class="p">)</span>
   <span class="k">print</span><span class="p">(</span><span class="n">y_data</span><span class="p">)</span>

   <span class="n">W</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">random_uniform</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">x_data</span><span class="p">)],</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">))</span>

   <span class="n">hypothesis</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">x_data</span><span class="p">)</span>

   <span class="k">print</span><span class="p">(</span><span class="n">hypothesis</span><span class="p">)</span>
   <span class="n">cost</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">reduce_mean</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">hypothesis</span> <span class="o">-</span> <span class="n">y_data</span><span class="p">))</span>

   <span class="n">a</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
   <span class="n">optimizer</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">GradientDescentOptimizer</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
   <span class="n">train</span> <span class="o">=</span> <span class="n">optimizer</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span><span class="n">cost</span><span class="p">)</span>

   <span class="n">init</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">global_variables_initializer</span><span class="p">()</span>

   <span class="n">sess</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span>
   <span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">init</span><span class="p">)</span>

   <span class="k">print</span><span class="p">(</span><span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">W</span><span class="p">))</span>
   <span class="c1"># print(sess.run(hypothesis))
</span>

   <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2001</span><span class="p">):</span>
       <span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">train</span><span class="p">)</span>
       <span class="k">if</span> <span class="n">step</span> <span class="o">%</span> <span class="mi">20</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
           <span class="k">print</span><span class="p">(</span> <span class="n">step</span><span class="p">,</span> <span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">cost</span><span class="p">),</span> <span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">W</span><span class="p">))</span>

   <span class="n">result</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">x_data</span><span class="p">)</span>
   <span class="c1"># ì‰¬ìš´ ì˜ˆì œì´ë¯€ë¡œ weightê°€ 0 1 1 ë¡œ ìˆ˜ë ´í•˜ëŠ”ê²ƒì„ í™•ì¸ í•  ìˆ˜ ìˆë‹¤.
</span>   <span class="k">print</span><span class="p">(</span><span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">result</span><span class="p">))</span>
</code></pre></div></div>
<ul>
  <li>ìœ„ ì˜ˆì œëŠ” íŒŒì¼ë¡œ í•˜ëŠ” ì˜ˆì œì´ë‹¤. ì…ë ¥ì€ 3ê°œ ë‹¨ìˆœí•œ ì˜ˆì œì´ë‹¤.</li>
</ul>

<p>05 - Logistic Classification</p>
<ul>
  <li>í•´ë‹¹ ì‚¬ì´íŠ¸ê°€ ì„¤ëª…ì„ ì˜í•˜ê³  ìˆë‹¤. <a href="https://blog.naver.com/lyshyn/221285013102">ë§í¬</a></li>
  <li>ìš°ì„  ì˜ˆ/ì•„ë‹ˆì˜¤ ê°™ì€ 2ê°€ì§€ë¡œ ë¶„ë¥˜í•˜ëŠ” ë°©ë²•ì´ë‹¤.</li>
  <li>linear regressionì—ì„œ íŒŒìƒëœê²ƒìœ¼ë¡œ y = wx + bì˜ í•¨ìˆ˜ë¥¼ ì°¾ëŠ” ë°©ë²•ì´ë‹¤.</li>
  <li>ê·¸ëŸ¬ë‚˜ ê´€ì¸¡ê°’ê³¼ ì˜ˆì¸¡ê°’ì˜ ì°¨ì´ ì¦‰ residualì€ ë³´í†µ 0~1ì‚¬ì´ì˜ ê°’ì„ ê°€ì§€ì§€ ì•ŠëŠ”ë‹¤.</li>
  <li>ê·¸ë˜ì„œ logistic regressionì„ ì‚¬ìš©í•´ì„œ 0~1ì‚¬ì´ì˜ ê°’ì„ ê°€ì§€ë„ë¡í•œë‹¤. ê·¸ë˜ì„œ ê´€ì¸¡ê°’ê³¼ ì˜ˆì¸¡ê°’ì˜ ì°¨ì´ëŠ” 0~1ì‚¬ì´ì˜ ê°’ì„ ê°€ì§€ê²Œ ëœë‹¤.</li>
  <li>
    <p>1/(1+exp(-W*X))
~~~ python</p>

    <p>script_dir = os.path.dirname(os.path.abspath(<strong>file</strong>))
  train_data = np.loadtxt(script_dir + â€˜/train.txtâ€™, unpack=True, dtype=â€™float32â€™)</p>

    <p>x_data = train_data[0:-1]
  y_data = train_data[-1]</p>

    <p>X = tf.placeholder(tf.float32)
  Y = tf.placeholder(tf.float32)</p>

    <p>W = tf.Variable(tf.random_uniform([1, len(x_data)], -1.0, 1.0))</p>

    <p>h = tf.matmul(W, X)
  hypothesis = tf.div(1., 1. + tf.exp(-h))</p>

    <p>cost = -tf.reduce_mean(Y<em>tf.log(hypothesis) + (1-Y)</em>tf.log(1 - hypothesis))</p>

    <p>a = tf.Variable(0.1)
  optimizer = tf.train.GradientDescentOptimizer(a)
  train = optimizer.minimize(cost)</p>

    <p>init = tf.global_variables_initializer()
  sess = tf.Session()
  sess.run(init)</p>

    <p>print((x_data))
  print((y_data))
  for step in range(2001):
      sess.run(train, feed_dict={X: x_data, Y: y_data})
      if step % 20 == 0:
          print(step, sess.run(cost, feed_dict={X: x_data, Y: y_data}), sess.run(W))</p>

    <p>print(sess.run(hypothesis, feed_dict={X: [[1], [2], [1]]}))
  print(sess.run(hypothesis, feed_dict={X: [[1], [3], [2]]}))
  print(sess.run(hypothesis, feed_dict={X: [[1], [3], [4]]}))
  print(sess.run(hypothesis, feed_dict={X: [[1], [5], [5]]}))
  print(sess.run(hypothesis, feed_dict={X: [[1], [7], [5]]}))
  print(sess.run(hypothesis, feed_dict={X: [[1], [2], [5]]}))</p>
    <h1 id="results">results</h1>
    <p>x_data : [[1. 1. 1. 1. 1. 1.]
 [2. 3. 3. 5. 7. 2.]
 [1. 2. 4. 5. 5. 5.]]
y_data : [0. 0. 0. 1. 1. 1.]
cost : 0.18209474 w : [[-7.674424    0.22860983  1.7167399 ]]</p>
  </li>
</ul>

<p>[[0.00404762]]
[[0.02768637]]
[[0.4694207]]
[[0.8862563]]
[[0.9248713]]
[[0.79688966]]</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ìœ„ì— ì…ë ¥ì„ ë‹¤ì‹œ ë„£ì–´ë´¤ë‹¤. [[1], [3], [4]]ëŠ” í™•ë¥ ì´ 0.4ê°€ ë‚˜ì™”ë‹¤.
~~~ python
  print( sess.run(hypothesis, feed_dict={X: [[1], [2], [2]]}) )
  print( sess.run(hypothesis, feed_dict={X: [[1], [5], [5]]}) )
  print( sess.run(hypothesis, feed_dict={X: [[1, 1], [4, 3], [3, 5]]}) )
#results
  [[0.02343233]]
  [[0.8850991]]
  [[0.17097047 0.83019507]]
</code></pre></div></div>
<p>ì†”ì§íˆ ì´ê±´ ëì˜ ìë¦¬ê°€ 5ì´ëƒ ì•„ë‹ˆëƒì´ë‹¤. ê·¸ë˜ì„œ ìœ„ë¥¼ ë³´ë©´ 5ì¼ë•Œ 0.5ë¥¼ ë„˜ê³  5ê°€ì•„ë‹ˆë©´ 0.5ê°€ ë„˜ì§€ ì•Šê²Œ ë‚˜ì˜¤ê³  ìˆëŠ”ê²ƒì„ í™•ì¸í•  ìˆ˜ìˆë‹¤.</p>

<p>06 - Softmax Regression</p>

<p>softmax = tf.exp(logits) / tf.reduce_sum(tf.exp(logits), axis)</p>
<ul>
  <li>tensorflow ì„¤ëª… : https://www.tensorflow.org/api_docs/python/tf/nn/softmax</li>
  <li>
    <p>sigmoidì™€ softmaxì˜ ì°¨ì´ : <a href="http://dataaspirant.com/2017/03/07/difference-between-softmax-function-and-sigmoid-function/">ë§í¬</a>
~~~ python
import tensorflow as tf
import numpy as np
import os</p>

    <p>script_dir = os.path.dirname(os.path.abspath(<strong>file</strong>))
train_data = np.loadtxt(script_dir + â€˜/train.txtâ€™, unpack=True, dtype=â€™float32â€™)
x_data = np.transpose(train_data[0:3])
y_data = np.transpose(train_data[3:])</p>

    <p>X = tf.placeholder(â€˜floatâ€™, [None, 3])
Y = tf.placeholder(â€˜floatâ€™, [None, 3])</p>

    <p>W = tf.Variable(tf.zeros([3, 3]))</p>

    <p>hypothesis = tf.nn.softmax(tf.matmul(X,W))
hypothesis_matmul2 = tf.exp(tf.matmul(X, W))</p>

    <p>learning_rate = 0.001</p>

    <p>cost = tf.reduce_mean(-tf.reduce_sum(Y * tf.log(hypothesis), reduction_indices=1))</p>

    <p>optimizer = tf.train.GradientDescentOptimizer(learning_rate)
train = optimizer.minimize(cost)</p>

    <p>init = tf.global_variables_initializer()</p>

    <p>with tf.Session() as sess:
    sess.run(init)</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>for step in xrange(2001):
    sess.run(train, feed_dict={X: x_data, Y: y_data})
    if step % 20 == 0:
        print step, sess.run(cost, feed_dict={X: x_data, Y: y_data}), sess.run(W)
</code></pre></div>    </div>

    <p>print(step, sess.run(hypothesis, feed_dict={X: [[1, 11, 7]]}))
  print(step, sess.run(hypothesis_matmul2, feed_dict={X: [[1, 11, 7]]}))</p>

    <p>a = sess.run(hypothesis, feed_dict={X: [[1, 11, 7]]})
  print(a, sess.run(tf.argmax(a, 1)))</p>
  </li>
</ul>

<h1 id="results-1">results</h1>
<p>2000 0.34592387
[[-0.0725141  -0.01358804  0.0861021 ]
 [ 0.02000793 -0.01168452 -0.00832341]
 [ 0.02207616  0.06482336 -0.08689948]]
2000 [[0.4149794  0.41895702 0.16606359]]
2000 [[1.352705   1.3656708  0.54131615]]
[[0.4149794  0.41895702 0.16606359]] [1]</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>- ìœ„ ê²°ê³¼ë¥¼ ë³´ë©´
results(1) = 1.352705 /(1.352705  + 1.3656708  + 0.54131615)
cost = tf.reduce_mean(-tf.reduce_sum(Y * tf.log(hypothesis), reduction_indices=1))
ë¡œ í•™ìŠµì„ í•˜ëŠ”ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤.
ìœ„ ì˜ˆì œëŠ” í•™ìŠµì„ í• ë•ŒëŠ” 9x3ìœ¼ë¡œ í•™ìŠµ í•˜ëŠ”ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤.
ì¦‰ ì…ë ¥ 9x3 x 3x3(weight) = ì¶œë ¥ 9x3ìœ¼ë¡œ í•™ìŠµì´ ë˜ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤.
argmaxëŠ” ê°€ì¥ í° ê°’ì˜ ì¸ë±ìŠ¤ë¥¼ ì•Œë ¤ì¤€ë‹¤.

Accuracy

~~~ python
  import tensorflow as tf

  from tensorflow.examples.tutorials.mnist import input_data
  mnist = input_data.read_data_sets("mnist/data/", one_hot=True)

  learning_rate = 0.01
  training_epochs = 25
  batch_size = 100
  display_step = 10

  x = tf.placeholder(tf.float32, shape=[None, 784])
  y = tf.placeholder(tf.float32, shape=[None, 10])

  W = tf.Variable(tf.zeros([784, 10]))
  b = tf.Variable(tf.zeros([10]))

  pred = tf.nn.softmax(tf.matmul(x, W) + b)

  cost = tf.reduce_mean(-tf.reduce_sum(y * tf.log(pred), reduction_indices=1))

  train = tf.train.GradientDescentOptimizer(learning_rate).minimize(cost)

  init = tf.global_variables_initializer()

  with tf.Session() as sess:
      sess.run(init)

      for epoch in range(training_epochs):
          avg_cost = 0.
          total_batch = int(mnist.train.num_examples/batch_size)

          for i in range(total_batch):
              batch_xs, batch_ys = mnist.train.next_batch(batch_size)
              _, c = sess.run([train, cost], feed_dict={x: batch_xs, y: batch_ys})
              avg_cost += c / total_batch

          if (epoch + 1) % display_step == 0:
              print "Epoch:", '%04d' % (epoch+1), "cost=", "{:.9f}".format(avg_cost)

      print 'Optimization Finished!'

      correct_prediction = tf.equal(tf.argmax(pred, 1), tf.argmax(y, 1))

      accuracy = tf.reduce_mean(tf.cast(correct_prediction, tf.float32))

      print "Accuracy:", accuracy.eval({x: mnist.test.images, y: mnist.test.labels})
</code></pre></div></div>

<!-- 02 - Linear Regression ê¹Œì§€ ì™„ë£Œ
- ì´ê²ƒ ì €ê²ƒ í•´ë³´ë©´ì„œ tensroflowì˜ ê¸°ë³¸ì„ ìµíˆê¸°ì— ì°¸ ì¢‹ì€ ì˜ˆì œì¸ ê²ƒ ê°™ë‹¤.
- When in the Go to Class, Go to Symbol, or Go to File popup,
- you can ease the search by filtering the lookup list with the help of the "camel words" prefixes. -->

<p>05 - Logistic Classification</p>
<ul>
  <li>ì„ì‹œ : http://liu.diva-portal.org/smash/get/diva2:117357/FULLTEXT05.pdf</li>
  <li>logistic Regression</li>
  <li>í•´ë‹¹ ì‚¬ì´íŠ¸ê°€ ì„¤ëª…ì„ ì˜í•˜ê³  ìˆë‹¤. <a href="https://blog.naver.com/lyshyn/221285013102">ë§í¬</a></li>
  <li>í•´ë‹¹ê¸€ì„ ì°¾ì•„ë³´ë‹¤ê°€ ì´í•´ê°€ ì•ˆë¼ì„œ ë‹¤ì‹œ ì°¾ì•˜ë‹¤. ì—¬ê¸° ë‚˜ì™€ ìˆë‹¤. ì–´ë µë„¤â€¦.</li>
  <li>íŒŒì´ì¬ ê¹€ì´ë¼ëŠ” ì‚¬ì´íŠ¸ì¸ë° ì¢‹ë‹¤.[Logistic Regression]http://pythonkim.tistory.com/22?category=573319</li>
  <li>ë”¥ëŸ¬ë‹ ë…¼ë¬¸ì½ê¸° ëª¨ì„ https://www.youtube.com/watch?v=iqN08EPMjSs&amp;index=68&amp;list=PLlMkM4tgfjnJhhd4wn5aj8fVTYJwIpWkS</li>
</ul>
:ET